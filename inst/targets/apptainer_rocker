BootStrap: docker
From: rocker/geospatial:latest

%post
   apt-get -y update
   apt-get install -y software-properties-common dirmngr
   add-apt-repository -y ppa:ubuntugis/ubuntugis-unstable
   apt-key adv --keyserver keyserver.ubuntu.com --recv-keys E298A3A825C0D65DFD57CBB651716619E084DAB9
   apt-get -y install gfortran libgdal-dev libgeos-dev libproj-dev gdal-bin
   Rscript -e "install.packages(c('pacman', 'future', 'future.apply'))"
   Rscript -e "install.packages('exactextractr')"
   Rscript -e "install.packages(c('tidytable', 'furrr', 'purrr', 'tidyr', 'dtplyr', 'data.table', 'collapse'))"
   Rscript -e "install.packages(c('nngeo', 'remotes', 'pak'))"
   Rscript -e 'install.packages(c("targets", "tarchetypes", "data.table", "sf", "terra", "exactextractr", "crew", "crew.cluster", "tigris", "dplyr", "future.batchtools", "qs", "collapse", "future", "future.apply", "future.callr", "callr", "sftime", "stars", "rlang", "foreach", "parallelly"))'
   Rscript -e "pak::pak('qs')"
   # Rscript -e "pak::pak('rspatial/terra')"
   # Rscript -e "pak::pak('NIEHS/chopin')"
   # Rscript -e "remotes::install_github('NIEHS/amadeus@isong-hucvars', force = TRUE)"
   mkdir /pipeline

%environment
   export LC_ALL=C

%files

%runscript

%labels
  Insang Song
